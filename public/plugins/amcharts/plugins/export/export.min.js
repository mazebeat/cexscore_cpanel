if(!AmCharts.translations["export"]){AmCharts.translations["export"]={}}if(!AmCharts.translations["export"]["en"]){AmCharts.translations["export"]["en"]={"fallback.save.text":"CTRL + C to copy the data into the clipboard.","fallback.save.image":"Rightclick -> Save picture as... to save the image.","capturing.delayed.menu.label":"{{duration}}","capturing.delayed.menu.title":"Click to cancel","menu.label.print":"Print","menu.label.undo":"Undo","menu.label.redo":"Redo","menu.label.cancel":"Cancel","menu.label.save.image":"Download as ...","menu.label.save.data":"Save as ...","menu.label.draw":"Annotate ...","menu.label.draw.change":"Change ...","menu.label.draw.add":"Add ...","menu.label.draw.shapes":"Shape ...","menu.label.draw.colors":"Color ...","menu.label.draw.widths":"Size ...","menu.label.draw.opacities":"Opacity ...","menu.label.draw.text":"Text","menu.label.draw.modes":"Mode ...","menu.label.draw.modes.pencil":"Pencil","menu.label.draw.modes.line":"Line","menu.label.draw.modes.arrow":"Arrow"}}(function(){AmCharts["export"]=function(b,a){var c={name:"export",version:"1.4.8",libs:{async:true,autoLoad:true,reload:false,resources:[{"pdfmake/pdfmake.js":["pdfmake/vfs_fonts.js"],"jszip/jszip.js":["xlsx/xlsx.js"]},"fabric.js/fabric.js","FileSaver.js/FileSaver.js"],namespaces:{"pdfmake.js":"pdfMake","jszip.js":"JSZip","xlsx.js":"XLSX","fabric.js":"fabric","FileSaver.js":"saveAs"}},config:{},setup:{chart:b,hasBlob:false,wrapper:false},drawing:{enabled:false,undos:[],redos:[],buffer:{position:{x1:0,y1:0,x2:0,y2:0,xD:0,yD:0}},handler:{undo:function(e,d){var f=c.drawing.undos.pop();if(f){f.selectable=true;c.drawing.redos.push(f);if(f.action=="added"){c.setup.fabric.remove(f.target)}var g=JSON.parse(f.state);f.target.set(g);if(f.target instanceof fabric.Group){c.drawing.handler.change({color:g.cfg.color,width:g.cfg.width,opacity:g.cfg.opacity},true,f.target)}c.setup.fabric.renderAll();if(f.state==f.target.recentState&&!d){c.drawing.handler.undo(f,true)}}},redo:function(e,d){var f=c.drawing.redos.pop();if(f){f.selectable=true;c.drawing.undos.push(f);if(f.action=="added"){c.setup.fabric.add(f.target)}var g=JSON.parse(f.state);f.target.recentState=f.state;f.target.set(g);if(f.target instanceof fabric.Group){c.drawing.handler.change({color:g.cfg.color,width:g.cfg.width,opacity:g.cfg.opacity},true,f.target)}c.setup.fabric.renderAll();if(f.action=="addified"){c.drawing.handler.redo()}}},done:function(d){c.drawing.buffer.enabled=false;c.drawing.undos=[];c.drawing.redos=[];c.createMenu(c.config.menu);c.setup.fabric.deactivateAll();if(c.setup.wrapper){c.setup.chart.containerDiv.removeChild(c.setup.wrapper);c.setup.wrapper=false}},add:function(e){var d=c.deepMerge({top:c.setup.fabric.height/2,left:c.setup.fabric.width/2},e||{});var f=d.url.indexOf(".svg")!=-1?fabric.loadSVGFromURL:fabric.Image.fromURL;f(d.url,function(i,g){var j=g!==undefined?fabric.util.groupSVGElements(i,g):i;var h=false;if(j.height>c.setup.fabric.height||j.width>c.setup.fabric.width){h=(c.setup.fabric.height/2)/j.height}if(d.top>c.setup.fabric.height){d.top=c.setup.fabric.height/2}if(d.left>c.setup.fabric.width){d.left=c.setup.fabric.width/2}j.set({originX:"center",originY:"center",top:d.top,left:d.left,width:h?j.width*h:j.width,height:h?j.height*h:j.height,fill:c.drawing.color});c.setup.fabric.add(j)})},change:function(l,j,h){var g=c.deepMerge({},l||{});var d,e,f;var i=h||c.drawing.buffer.target;var k=i?i._objects?i._objects:[i]:null;if(g.mode){c.drawing.mode=g.mode}if(g.width){c.drawing.width=g.width;c.drawing.fontSize=g.width*3}if(g.fontSize){c.drawing.fontSize=g.fontSize}if(g.color){c.drawing.color=g.color}if(g.opacity){c.drawing.opacity=g.opacity}f=new fabric.Color(c.drawing.color).getSource();f.pop();f.push(c.drawing.opacity);c.drawing.color="rgba("+f.join()+")";c.setup.fabric.freeDrawingBrush.color=c.drawing.color;c.setup.fabric.freeDrawingBrush.width=c.drawing.width;if(i){d=JSON.parse(i.recentState).cfg;if(d){g.color=g.color||d.color;g.width=g.width||d.width;g.opacity=g.opacity||d.opacity;g.fontSize=g.fontSize||g.width*3;f=new fabric.Color(g.color).getSource();f.pop();f.push(g.opacity);g.color="rgba("+f.join()+")"}for(e=0;e<k.length;e++){if(k[e] instanceof fabric.Text||k[e] instanceof fabric.PathGroup||k[e] instanceof fabric.Triangle){if(g.color||g.opacity){k[e].set({fill:g.color})}if(g.fontSize){k[e].set({fontSize:g.fontSize})}}else{if(k[e] instanceof fabric.Path||k[e] instanceof fabric.Line){if(i instanceof fabric.Group){if(g.color||g.opacity){k[e].set({stroke:g.color})}}else{if(g.color||g.opacity){k[e].set({stroke:g.color})}if(g.width){k[e].set({strokeWidth:g.width})}}}}}if(!j){d=JSON.stringify(c.deepMerge(i.saveState().originalState,{cfg:{color:g.color,width:g.width,opacity:g.opacity}}));i.recentState=d;c.drawing.redos=[];c.drawing.undos.push({action:"modified",target:i,state:d})}c.setup.fabric.renderAll()}},text:function(e){var d=c.deepMerge({text:c.i18l("menu.label.draw.text"),top:c.setup.fabric.height/2,left:c.setup.fabric.width/2,fontSize:c.drawing.fontSize,fontFamily:c.setup.chart.fontFamily||"Verdana",fill:c.drawing.color},e||{});d.click=function(){};var f=new fabric.IText(d.text,d);c.setup.fabric.add(f);c.setup.fabric.setActiveObject(f);f.selectAll();f.enterEditing();return f},line:function(g){var e=c.deepMerge({x1:(c.setup.fabric.width/2)-(c.setup.fabric.width/10),x2:(c.setup.fabric.width/2)+(c.setup.fabric.width/10),y1:(c.setup.fabric.height/2),y2:(c.setup.fabric.height/2),angle:90,strokeLineCap:c.drawing.lineCap,arrow:c.drawing.arrow,color:c.drawing.color,width:c.drawing.width,group:[],},g||{});var h,i,f,k;var d=new fabric.Line([e.x1,e.y1,e.x2,e.y2],{stroke:e.color,strokeWidth:e.width,strokeLineCap:e.strokeLineCap});e.group.push(d);if(e.arrow){e.angle=e.angle?e.angle:c.getAngle(e.x1,e.y1,e.x2,e.y2);if(e.arrow=="start"){f=e.y1+(e.width/2);k=e.x1+(e.width/2)}else{if(e.arrow=="middle"){f=e.y2+(e.width/2)-((e.y2-e.y1)/2);k=e.x2+(e.width/2)-((e.x2-e.x1)/2)}else{f=e.y2+(e.width/2);k=e.x2+(e.width/2)}}i=new fabric.Triangle({top:f,left:k,fill:e.color,height:e.width*7,width:e.width*7,angle:e.angle,originX:"center",originY:"bottom"});e.group.push(i)}if(e.action!="config"){if(e.arrow){var j=new fabric.Group(e.group);j.set({cfg:e,fill:e.color,action:e.action,selectable:true,known:e.action=="change"});if(e.action=="change"){c.setup.fabric.setActiveObject(j)}c.setup.fabric.add(j);return j}else{c.setup.fabric.add(d);return d}}else{for(h=0;h<e.group.length;h++){e.group[h].noUndo=true;c.setup.fabric.add(e.group[h])}}return e}}},defaults:{position:"top-right",fileName:"amCharts",action:"download",overflow:true,path:((b.path||"")+"plugins/export/"),formats:{JPG:{mimeType:"image/jpg",extension:"jpg",capture:true},PNG:{mimeType:"image/png",extension:"png",capture:true},SVG:{mimeType:"text/xml",extension:"svg",capture:true},PDF:{mimeType:"application/pdf",extension:"pdf",capture:true},CSV:{mimeType:"text/plain",extension:"csv"},JSON:{mimeType:"text/plain",extension:"json"},XLSX:{mimeType:"application/octet-stream",extension:"xlsx"}},fabric:{backgroundColor:"#FFFFFF",removeImages:true,selection:false,drawing:{enabled:true,arrow:"end",lineCap:"butt",mode:"pencil",modes:["pencil","line","arrow"],color:"#000000",colors:["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF"],shapes:["11.svg","14.svg","16.svg","17.svg","20.svg","27.svg"],width:1,fontSize:11,widths:[1,5,10,15],opacity:1,opacities:[1,0.8,0.6,0.4,0.2],menu:undefined,autoClose:true}},pdfMake:{pageSize:"A4",pageOrientation:"portrait",images:{},content:["Saved from:",window.location.href,{image:"reference",fit:[523.28,769.89]}]},menu:undefined,divId:null,menuReviver:null,menuWalker:null,fallback:true,keyListener:true,fileListener:true},i18l:function(e,g){var f=g?langugage:c.setup.chart.language?c.setup.chart.language:"en";var d=AmCharts.translations[c.name][f]||AmCharts.translations[c.name]["en"];return d[e]||e},download:function(i,h,g){if(window.saveAs&&c.setup.hasBlob){var f=c.toBlob({data:i,type:h},function(l){saveAs(l,g)})}else{if(c.config.fallback&&h=="text/plain"){var k=document.createElement("div");var j=document.createElement("div");var d=document.createElement("textarea");j.innerHTML=c.i18l("fallback.save.text");k.appendChild(j);k.appendChild(d);j.setAttribute("class","amcharts-export-fallback-message");k.setAttribute("class","amcharts-export-fallback");c.setup.chart.containerDiv.appendChild(k);d.setAttribute("readonly","");d.value=i;d.focus();d.select();c.createMenu([{"class":"export-main export-close",label:"Done",click:function(){c.createMenu(c.config.menu);c.setup.chart.containerDiv.removeChild(k)}}])}else{if(c.config.fallback&&h.split("/")[0]=="image"){var k=document.createElement("div");var j=document.createElement("div");var e=c.toImage({data:i});j.innerHTML=c.i18l("fallback.save.image");k.appendChild(j);k.appendChild(e);j.setAttribute("class","amcharts-export-fallback-message");k.setAttribute("class","amcharts-export-fallback");c.setup.chart.containerDiv.appendChild(k);c.createMenu([{"class":"export-main export-close",label:"Done",click:function(){c.createMenu(c.config.menu);c.setup.chart.containerDiv.removeChild(k)}}])}else{throw new Error("Unable to create file. Ensure saveAs (FileSaver.js) is supported.")}}}return i},loadResource:function(d,l){var i,j,g,n,f,k;var e=d.indexOf("//")!=-1?d:[c.libs.path,d].join("");function m(){if(l){for(i=0;i<l.length;i++){c.loadResource(l[i])}}}if(d.indexOf(".js")!=-1){g=document.createElement("script");g.setAttribute("type","text/javascript");g.setAttribute("src",e);if(c.libs.async){g.setAttribute("async","")}}else{if(d.indexOf(".css")!=-1){g=document.createElement("link");g.setAttribute("type","text/css");g.setAttribute("rel","stylesheet");g.setAttribute("href",e)}}for(i=0;i<document.head.childNodes.length;i++){n=document.head.childNodes[i];f=n?(n.src||n.href):false;k=n?n.tagName:false;if(n&&f&&f.indexOf(d)!=-1){if(c.libs.reload){document.head.removeChild(n)}j=true;break}}for(i in c.libs.namespaces){var h=c.libs.namespaces[i];var f=d.toLowerCase();var n=i.toLowerCase();if(f.indexOf(n)!=-1&&window[h]!==undefined){j=true;break}}if(!j||c.libs.reload){g.addEventListener("load",m);document.head.appendChild(g)}},loadDependencies:function(){var e,d;if(c.libs.autoLoad){for(e=0;e<c.libs.resources.length;e++){if(c.libs.resources[e] instanceof Object){for(d in c.libs.resources[e]){c.loadResource(d,c.libs.resources[e][d])}}else{c.loadResource(c.libs.resources[e])}}}},pxToNumber:function(d,e){if(!d&&e){return undefined}return Number(String(d).replace("px",""))||0},numberToPx:function(d){return String(d)+"px"},deepMerge:function(e,d,g){var i,f,h=d instanceof Array?"array":"object";for(i in d){if(h=="array"&&isNaN(i)){continue}f=d[i];if(e[i]==undefined||g){if(f instanceof Array){e[i]=[]}else{if(f instanceof Function){e[i]=new Function()}else{if(f instanceof Date){e[i]=new Date()}else{if(f instanceof Object){e[i]={}}else{if(f instanceof Number){e[i]=Number()}else{if(f instanceof String){e[i]=String()}}}}}}}if((e instanceof Object||e instanceof Array)&&(f instanceof Object||f instanceof Array)&&!(f instanceof Function||f instanceof Date||c.isElement(f))&&i!="chart"){c.deepMerge(e[i],f,g)}else{if(e instanceof Array&&!g){e.push(f)}else{e[i]=f}}}return e},isElement:function(d){return d instanceof Object&&d&&d.nodeType===1},isHashbanged:function(d){var e=String(d).replace(/\"/g,"");return e.slice(0,3)=="url"?e.slice(e.indexOf("#")+1,e.length-1):false},isPressed:function(d){if(d.type=="mousemove"&&d.which===1){}else{if(d.type=="touchmove"||d.buttons===1||d.button===1||d.which===1){c.drawing.buffer.isPressed=true}else{c.drawing.buffer.isPressed=false}}return c.drawing.buffer.isPressed},isTainted:function(e){var d=String(window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));if(e&&e.indexOf("//")!=-1&&e.indexOf(d.replace(/.*:/,""))==-1){return true}return false},isSupported:function(){if(!c.config.enabled){return false}if(AmCharts.isIE&&AmCharts.IEversion<=9){if(!Array.prototype.indexOf||!document.head||c.config.fallback===false){return false}}return true},getAngle:function(f,h,e,g){var d=e-f;var j=g-h;var i;if(d==0){if(j==0){i=0}else{if(j>0){i=Math.PI/2}else{i=Math.PI*3/2}}}else{if(j==0){if(d>0){i=0}else{i=Math.PI}}else{if(d<0){i=Math.atan(j/d)+Math.PI}else{if(j<0){i=Math.atan(j/d)+(2*Math.PI)}else{i=Math.atan(j/d)}}}}return i*180/Math.PI},gatherAttribute:function(h,d,e,f){var g,f=f?f:0,e=e?e:3;if(h){g=h.getAttribute(d);if(!g&&f<e){return c.gatherAttribute(h.parentNode,d,e,f+1)}}return g},gatherClassName:function(h,f,d,e){var g,e=e?e:0,d=d?d:3;if(c.isElement(h)){g=(h.getAttribute("class")||"").split(" ").indexOf(f)!=-1;if(!g&&e<d){return c.gatherClassName(h.parentNode,f,d,e+1)}else{if(g){g=h}}}return g},gatherElements:function(k,h,j){var g,f;for(g=0;g<k.children.length;g++){var d=k.children[g];if(d.tagName=="clipPath"){var l={};var e=fabric.parseTransformAttribute(c.gatherAttribute(d,"transform"));for(f=0;f<d.childNodes.length;f++){d.childNodes[f].setAttribute("fill","transparent");l={x:c.pxToNumber(d.childNodes[f].getAttribute("x")),y:c.pxToNumber(d.childNodes[f].getAttribute("y")),width:c.pxToNumber(d.childNodes[f].getAttribute("width")),height:c.pxToNumber(d.childNodes[f].getAttribute("height"))}}k.clippings[d.id]={svg:d,bbox:l,transform:e}}else{if(d.tagName=="pattern"){var i={node:d,source:d.getAttribute("xlink:href"),width:Number(d.getAttribute("width")),height:Number(d.getAttribute("height")),repeat:"repeat"};for(f=0;f<d.childNodes.length;f++){if(d.childNodes[f].tagName=="rect"){i.fill=d.childNodes[f].getAttribute("fill")}}if(h.removeImages&&c.isTainted(i.source)){k.patterns[d.id]=i.fill?i.fill:"transparent"}else{j.included++;k.patterns[i.node.id]=i}}else{if(d.tagName=="image"){j.included++;fabric.Image.fromURL(d.getAttribute("xlink:href"),function(m){j.loaded++})}}}}return k},gatherPosition:function(f,d){var e=c.drawing.buffer.position;var g=fabric.util.invertTransform(c.setup.fabric.viewportTransform);var h;if(f.type=="touchmove"){if("touches" in f){f=f.touches[0]}else{if("changedTouches" in f){f=f.changedTouches[0]}}}h=fabric.util.transformPoint(c.setup.fabric.getPointer(f,true),g);if(d==1){e.x1=h.x;e.y1=h.y}e.x2=h.x;e.y2=h.y;e.xD=(e.x1-e.x2)<0?(e.x1-e.x2)*-1:(e.x1-e.x2);e.yD=(e.y1-e.y2)<0?(e.y1-e.y2)*-1:(e.y1-e.y2);return e},capture:function(p,n){var e;var h=c.deepMerge(c.deepMerge({},c.config.fabric),p||{});var d=[];var f={x:0,y:0,pX:0,pY:0,width:c.setup.chart.divRealWidth,height:c.setup.chart.divRealHeight};var i={loaded:0,included:0};fabric.ElementsParser.prototype.resolveGradient=function(t,s){var q=t.get(s);if(!(/^url\(/).test(q)){return}var r=q.slice(q.indexOf("#")+1,q.length-1);if(fabric.gradientDefs[this.svgUid][r]){t.set(s,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}};c.handleCallback(h.beforeCapture,h);var l=c.setup.chart.containerDiv.getElementsByTagName("svg");for(e=0;e<l.length;e++){var m={svg:l[e],parent:l[e].parentNode,children:l[e].getElementsByTagName("*"),offset:{x:0,y:0},patterns:{},clippings:{}};m=c.gatherElements(m,h,i);d.push(m)}if(c.config.legend&&c.setup.chart.legend&&c.setup.chart.legend.position=="outside"){var m={svg:c.setup.chart.legend.container.container,parent:c.setup.chart.legend.container.container.parentNode,children:c.setup.chart.legend.container.container.getElementsByTagName("*"),offset:{x:0,y:0},legend:{type:["top","left"].indexOf(c.config.legend.position)!=-1?"unshift":"push",position:c.config.legend.position,width:c.config.legend.width?c.config.legend.width:c.setup.chart.legend.container.width,height:c.config.legend.height?c.config.legend.height:c.setup.chart.legend.container.height},patterns:{},clippings:{}};if(["left","right"].indexOf(m.legend.position)!=-1){f.width+=m.legend.width;f.height=m.legend.height>f.height?m.legend.height:f.height}else{if(["top","bottom"].indexOf(m.legend.position)!=-1){f.height+=m.legend.height}}m=c.gatherElements(m,h,i);d[m.legend.type](m)}c.drawing.buffer.enabled=h.action=="draw";c.setup.wrapper=document.createElement("div");c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas");c.setup.chart.containerDiv.appendChild(c.setup.wrapper);if(c.setup.chart.type=="stock"){var k={top:0,right:0,bottom:0,left:0};if(c.setup.chart.leftContainer){f.width-=c.setup.chart.leftContainer.offsetWidth;k.left=c.setup.chart.leftContainer.offsetWidth+(c.setup.chart.panelsSettings.panelSpacing*2)}if(c.setup.chart.rightContainer){f.width-=c.setup.chart.rightContainer.offsetWidth;k.right=c.setup.chart.rightContainer.offsetWidth+(c.setup.chart.panelsSettings.panelSpacing*2)}if(c.setup.chart.periodSelector&&["top","bottom"].indexOf(c.setup.chart.periodSelector.position)!=-1){f.height-=c.setup.chart.periodSelector.offsetHeight+c.setup.chart.panelsSettings.panelSpacing;k[c.setup.chart.periodSelector.position]+=c.setup.chart.periodSelector.offsetHeight+c.setup.chart.panelsSettings.panelSpacing}if(c.setup.chart.dataSetSelector&&["top","bottom"].indexOf(c.setup.chart.dataSetSelector.position)!=-1){f.height-=c.setup.chart.dataSetSelector.offsetHeight;k[c.setup.chart.dataSetSelector.position]+=c.setup.chart.dataSetSelector.offsetHeight}c.setup.wrapper.style.paddingTop=c.numberToPx(k.top);c.setup.wrapper.style.paddingRight=c.numberToPx(k.right);c.setup.wrapper.style.paddingBottom=c.numberToPx(k.bottom);c.setup.wrapper.style.paddingLeft=c.numberToPx(k.left)}c.setup.canvas=document.createElement("canvas");c.setup.wrapper.appendChild(c.setup.canvas);c.setup.fabric=new fabric.Canvas(c.setup.canvas,c.deepMerge({width:f.width,height:f.height,isDrawingMode:true},h));c.deepMerge(c.setup.fabric,h);c.deepMerge(c.setup.fabric.freeDrawingBrush,h.drawing);c.deepMerge(c.drawing,h.drawing);c.drawing.handler.change(h.drawing);c.setup.fabric.on("mouse:down",function(r){var q=c.gatherPosition(r.e,1);c.drawing.buffer.pressedTS=Number(new Date());c.isPressed(r.e)});c.setup.fabric.on("mouse:move",function(v){var u=c.gatherPosition(v.e,2);c.isPressed(v.e);if(c.drawing.buffer.isPressed&&!c.drawing.buffer.line){if(!c.drawing.buffer.isSelected&&c.drawing.mode!="pencil"&&(u.xD>5||u.xD>5)){c.drawing.buffer.hasLine=true;c.setup.fabric.isDrawingMode=false;c.setup.fabric._onMouseUpInDrawingMode(v);c.drawing.buffer.line=c.drawing.handler.line({x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,arrow:c.drawing.mode=="line"?false:c.drawing.arrow,action:"config"})}}if(c.drawing.buffer.line){var t,s,r;var q=c.drawing.buffer.line;q.x2=u.x2;q.y2=u.y2;for(e=0;e<q.group.length;e++){t=q.group[e];if(t instanceof fabric.Line){t.set({x2:q.x2,y2:q.y2})}else{if(t instanceof fabric.Triangle){q.angle=(c.getAngle(q.x1,q.y1,q.x2,q.y2)+90);if(q.arrow=="start"){s=q.y1+(q.width/2);r=q.x1+(q.width/2)}else{if(q.arrow=="middle"){s=q.y2+(q.width/2)-((q.y2-q.y1)/2);r=q.x2+(q.width/2)-((q.x2-q.x1)/2)}else{s=q.y2+(q.width/2);r=q.x2+(q.width/2)}}t.set({top:s,left:r,angle:q.angle})}}}c.setup.fabric.renderAll()}});c.setup.fabric.on("mouse:up",function(r){if(Number(new Date())-c.drawing.buffer.pressedTS<200){var q=c.setup.fabric.findTarget(r.e);if(q&&q.selectable){c.setup.fabric.setActiveObject(q)}}if(c.drawing.buffer.line){for(e=0;e<c.drawing.buffer.line.group.length;e++){c.drawing.buffer.line.group[e].remove()}delete c.drawing.buffer.line.action;delete c.drawing.buffer.line.group;c.drawing.handler.line(c.drawing.buffer.line)}c.drawing.buffer.line=false;c.drawing.buffer.hasLine=false;c.drawing.buffer.isPressed=false});c.setup.fabric.on("object:selected",function(q){c.drawing.buffer.isSelected=true;c.drawing.buffer.target=q.target;c.setup.fabric.isDrawingMode=false});c.setup.fabric.on("selection:cleared",function(q){c.drawing.buffer.onMouseDown=c.setup.fabric.freeDrawingBrush.onMouseDown;c.drawing.buffer.target=false;if(c.drawing.buffer.isSelected){c.setup.fabric._isCurrentlyDrawing=false;c.setup.fabric.freeDrawingBrush.onMouseDown=function(){}}setTimeout(function(){c.drawing.buffer.isSelected=false;c.setup.fabric.isDrawingMode=true;c.setup.fabric.freeDrawingBrush.onMouseDown=c.drawing.buffer.onMouseDown},10)});c.setup.fabric.on("path:created",function(r){var q=r.path;if(Number(new Date())-c.drawing.buffer.pressedTS<200||c.drawing.buffer.hasLine){c.setup.fabric.remove(q);c.setup.fabric.renderAll()}});c.setup.fabric.on("object:added",function(s){var q=s.target;var r=c.deepMerge(q.saveState().originalState,{cfg:{color:c.drawing.color,width:c.drawing.width,opacity:c.drawing.opacity,fontSize:c.drawing.fontSize}});if(Number(new Date())-c.drawing.buffer.pressedTS<200&&!q.noUndo){c.setup.fabric.remove(q);c.setup.fabric.renderAll();return}r=JSON.stringify(r);q.recentState=r;if(q.selectable&&!q.known&&!q.noUndo){c.drawing.undos.push({action:"added",target:q,state:r});c.drawing.undos.push({action:"addified",target:q,state:r});c.drawing.redos=[]}q.known=true;c.setup.fabric.isDrawingMode=true});c.setup.fabric.on("object:modified",function(t){var r=t.target;var q=JSON.parse(r.recentState);var s=c.deepMerge(r.saveState().originalState,{cfg:q.cfg});s=JSON.stringify(s);r.recentState=s;c.drawing.undos.push({action:"modified",target:r,state:s});c.drawing.redos=[]});c.setup.fabric.on("text:changed",function(r){var q=r.target;clearTimeout(q.timer);q.timer=setTimeout(function(){var s=JSON.stringify(q.saveState().originalState);q.recentState=s;c.drawing.redos=[];c.drawing.undos.push({action:"modified",target:q,state:s})},250)});if(c.drawing.buffer.enabled){c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active");c.setup.wrapper.style.backgroundColor=h.backgroundColor;c.setup.wrapper.style.display="block"}else{c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas");c.setup.wrapper.style.display="none"}for(e=0;e<d.length;e++){var m=d[e];var g=c.gatherClassName(m.parent,c.setup.chart.classNamePrefix+"-legend-div",1);var o=c.gatherClassName(m.parent,c.setup.chart.classNamePrefix+"-stock-panel-div");var j=c.gatherClassName(m.parent,c.setup.chart.classNamePrefix+"-scrollbar-chart-div");if(c.setup.chart.type=="stock"&&c.setup.chart.legendSettings.position){if(["top","bottom"].indexOf(c.setup.chart.legendSettings.position)!=-1){if(m.parent.style.top&&m.parent.style.left){m.offset.y=c.pxToNumber(m.parent.style.top);m.offset.x=c.pxToNumber(m.parent.style.left)}else{m.offset.x=f.x;m.offset.y=f.y;f.y+=c.pxToNumber(m.parent.style.height);if(o){f.pY=c.pxToNumber(o.style.marginTop);m.offset.y+=f.pY}else{if(j){m.offset.y+=f.pY}}}}else{if(["left","right"].indexOf(c.setup.chart.legendSettings.position)!=-1){m.offset.y=c.pxToNumber(m.parent.style.top)+f.pY;m.offset.x=c.pxToNumber(m.parent.style.left)+f.pX;if(g){f.pY+=c.pxToNumber(o.style.height)+c.setup.chart.panelsSettings.panelSpacing}else{if(j){m.offset.y-=c.setup.chart.panelsSettings.panelSpacing}}}}}else{if(m.parent.style.position=="absolute"){m.offset.absolute=true;m.offset.top=c.pxToNumber(m.parent.style.top);m.offset.right=c.pxToNumber(m.parent.style.right,true);m.offset.bottom=c.pxToNumber(m.parent.style.bottom,true);m.offset.left=c.pxToNumber(m.parent.style.left);m.offset.width=c.pxToNumber(m.parent.style.width);m.offset.height=c.pxToNumber(m.parent.style.height)}else{if(m.parent.style.top&&m.parent.style.left){m.offset.y=c.pxToNumber(m.parent.style.top);m.offset.x=c.pxToNumber(m.parent.style.left)}else{if(m.legend){if(m.legend.position=="left"){f.x+=m.legend.width}else{if(m.legend.position=="right"){m.offset.x+=f.width-m.legend.width}else{if(m.legend.position=="top"){f.y+=m.legend.height}else{if(m.legend.position=="bottom"){m.offset.y+=f.height-m.legend.height}}}}}else{m.offset.x=f.x;m.offset.y=f.y+f.pY;f.y+=c.pxToNumber(m.parent.style.height)}}}if(g&&o&&o.style.marginTop){f.y+=c.pxToNumber(o.style.marginTop);m.offset.y+=c.pxToNumber(o.style.marginTop)}}fabric.parseSVGDocument(m.svg,(function(q){return function(s,u){var E;var I=fabric.util.groupSVGElements(s,u);var C=[];var K={selectable:false};if(q.offset.absolute){if(q.offset.bottom!==undefined){K.top=f.height-q.offset.height-q.offset.bottom}else{K.top=q.offset.top}if(q.offset.right!==undefined){K.left=f.width-q.offset.width-q.offset.right}else{K.left=q.offset.left}}else{K.top=q.offset.y;K.left=q.offset.x}for(E=0;E<I.paths.length;E++){var B=null;if(I.paths[E]){if(h.removeImages&&c.isTainted(I.paths[E]["xlink:href"])){continue}if(I.paths[E].fill instanceof Object){if(I.paths[E].fill.type=="radial"){I.paths[E].fill.coords.r2=I.paths[E].fill.coords.r1*-1;I.paths[E].fill.coords.r1=0}I.paths[E].set({opacity:I.paths[E].fillOpacity})}else{if(B=c.isHashbanged(I.paths[E].fill)){if(q.patterns&&q.patterns[B]){var t=q.patterns[B];fabric.Image.fromURL(t.source,(function(L,M){return function(N){i.loaded++;var O=null;var P=new fabric.StaticCanvas(undefined,{backgroundColor:L.fill});P.add(N);O=new fabric.Pattern({source:function(){P.setDimensions({width:L.width,height:L.height});return P.getElement()},repeat:"repeat"});I.paths[M].set({fill:O,opacity:I.paths[M].fillOpacity})}})(t,E))}}}if(B=c.isHashbanged(I.paths[E].clipPath)){if(q.clippings&&q.clippings[B]){I.paths[E].set({clipTo:(function(L,M){return function(O){var Q=q.clippings[M];var N=this.transformMatrix||[1,0,0,1,0,0];var P={top:(Q.bbox.y-N[5])+Q.transform[5],left:(Q.bbox.x-N[4])+Q.transform[4],width:Q.bbox.width,height:Q.bbox.height};O.rect(P.left,P.top,P.width,P.height)}})(E,B)})}}if(I.paths[E].TSPANWORKAROUND){var r=fabric.parseAttributes(I.paths[E].svg,fabric.Text.ATTRIBUTE_NAMES);var u=fabric.util.object.extend({},r);var z=[];for(var G=0;G<I.paths[E].svg.childNodes.length;G++){var A=I.paths[E].svg.childNodes[G];var J=fabric.Text.fromElement(A,u);J.set({left:0});z.push(J)}I.paths[E].set({opacity:0});var H=new fabric.Group(z,{top:I.paths[E].top*-1});c.setup.fabric.add(H)}}C.push(I.paths[E])}I.paths=C;I.set(K);c.setup.fabric.add(I);if(q.svg.parentNode&&q.svg.parentNode.getElementsByTagName){var w=q.svg.parentNode.getElementsByClassName(c.setup.chart.classNamePrefix+"-balloon-div");for(E=0;E<w.length;E++){if(h.balloonFunction instanceof Function){h.balloonFunction.apply(c,[w[E],q])}else{var x=w[E];var y=fabric.parseStyleAttribute(x);var F=fabric.parseStyleAttribute(x.childNodes[0]);var D=new fabric.Text(x.innerText||x.innerHTML,{selectable:false,top:y.top+q.offset.y,left:y.left+q.offset.x,fill:F.color,fontSize:F.fontSize,fontFamily:F.fontFamily,textAlign:F["text-align"]});c.setup.fabric.add(D)}}}if(q.svg.nextSibling&&q.svg.nextSibling.tagName=="A"){var x=q.svg.nextSibling;var y=fabric.parseStyleAttribute(x);var D=new fabric.Text(x.innerText||x.innerHTML,{selectable:false,top:y.top+q.offset.y,left:y.left+q.offset.x,fill:y.color,fontSize:y.fontSize,fontFamily:y.fontFamily,opacity:y.opacity});c.setup.fabric.add(D)}d.pop();if(!d.length){var v=setInterval(function(){if(i.loaded==i.included){clearTimeout(v);c.handleCallback(h.afterCapture,h);c.setup.fabric.renderAll();c.handleCallback(n,h)}},AmCharts.updateRate)}}})(m),function(u,t){var s;var z=c.gatherAttribute(u,"class");var q=c.gatherAttribute(u,"visibility");var y=c.gatherAttribute(u,"clip-path");t.className=String(z);t.classList=String(z).split(" ");t.clipPath=y;t.svg=u;if(u.tagName=="text"&&u.childNodes.length>1){t.TSPANWORKAROUND=true}if(q=="hidden"){t.opacity=0}else{var A=["fill","stroke"];for(s=0;s<A.length;s++){var x=A[s];var w=String(u.getAttribute(x)||"");var r=Number(u.getAttribute(x+"-opacity")||"1");var v=fabric.Color.fromHex(w).getSource();if(t.classList.indexOf(c.setup.chart.classNamePrefix+"-guide-fill")!=-1&&!w){r=0;v=fabric.Color.fromHex("#000000").getSource()}if(v){v.pop();v.push(r);t[x]="rgba("+v.join()+")";t[x+c.capitalize("opacity")]=r}}}c.handleCallback(h.reviver,t,u)})}},toCanvas:function(e,g){var d=c.deepMerge({},e||{});var f=c.setup.canvas;c.handleCallback(g,f);return f},toImage:function(f,h){var d=c.deepMerge({format:"png",quality:1,multiplier:1},f||{});var g=d.data;var e=document.createElement("img");if(!d.data){if(d.lossless||d.format=="svg"){g=c.toSVG(c.deepMerge(d,{getBase64:true}))}else{g=c.setup.fabric.toDataURL(d)}}e.setAttribute("src",g);c.handleCallback(h,e);return e},toBlob:function(e,h){var d=c.deepMerge({data:"empty",type:"text/plain"},e||{});var f;var g=/^data:.+;base64,(.*)$/.exec(d.data);if(g){d.data=g[0];d.type=d.data.slice(5,d.data.indexOf(",")-7);d.data=c.toByteArray({data:d.data.slice(d.data.indexOf(",")+1,d.data.length)})}if(d.getByteArray){f=d.data}else{f=new Blob([d.data],{type:d.type})}c.handleCallback(h,f);return f},toJPG:function(e,g){var d=c.deepMerge({format:"jpeg",quality:1,multiplier:1},e||{});d.format=d.format.toLowerCase();var f=c.setup.fabric.toDataURL(d);c.handleCallback(g,f);return f},toPNG:function(e,g){var d=c.deepMerge({format:"png",quality:1,multiplier:1},e||{});var f=c.setup.fabric.toDataURL(d);c.handleCallback(g,f);return f},toSVG:function(e,g){var d=c.deepMerge({reviver:function(m){var l=new RegExp(/\bstyle=(['"])(.*?)\1/);var k=l.exec(m)[0].slice(7,-1);var q=k.split(";");var h=[];for(i1=0;i1<q.length;i1++){if(q[i1]){var j=q[i1].replace(/\s/g,"").split(":");var p=j[0];var o=j[1];if(["fill","stroke"].indexOf(p)!=-1){o=fabric.Color.fromRgba(o);if(o&&o._source){var i="#"+o.toHex();var n=o._source[3];h.push([p,i].join(":"));h.push([p+"-opacity",n].join(":"))}else{h.push(q[i1])}}else{if(p!="opactiy"){h.push(q[i1])}}}}return m.replace(k,h.join(";"))}},e||{});var f=c.setup.fabric.toSVG(d,d.reviver);if(d.getBase64){f="data:image/svg+xml;base64,"+btoa(f)}c.handleCallback(g,f);return f},toPDF:function(e,g){var d=c.deepMerge(c.deepMerge({multiplier:2},c.config.pdfMake),e||{},true);d.images.reference=c.toPNG(d);var f=new pdfMake.createPdf(d);if(g){f.getDataUrl((function(h){return function(){h.apply(c,arguments)}})(g))}return f},toPRINT:function(g,j){var h;var d=c.deepMerge({delay:1,lossless:false},g||{});var i=c.toImage(d);var f=[];var e=document.body.childNodes;i.setAttribute("style","width: 100%; max-height: 100%;");for(h=0;h<e.length;h++){if(c.isElement(e[h])){f[h]=e[h].style.display;e[h].style.display="none"}}document.body.appendChild(i);window.print();setTimeout(function(){for(h=0;h<e.length;h++){if(c.isElement(e[h])){e[h].style.display=f[h]}}document.body.removeChild(i);c.handleCallback(j,i)},d.delay);return i},toJSON:function(e,g){var d=c.deepMerge({dateFormat:c.config.dateFormat||"dateObject",},e||{},true);d.data=d.data?d.data:c.getChartData(d);var f=JSON.stringify(d.data,undefined,"\t");c.handleCallback(g,f);return f},toCSV:function(n,l){var m,d;var h=c.deepMerge({data:c.getChartData(n),delimiter:",",quotes:true,escape:true,withHeader:true},n||{},true);var g="";var j=[];var f=[];function i(p,o){if(typeof p==="string"){if(h.escape){p=p.replace('"','""')}if(h.quotes){p=['"',p,'"'].join("")}}return p}for(k in h.data[0]){f.push(i(k));j.push(k)}if(h.withHeader){g+=f.join(h.delimiter)+"\n"}for(m in h.data){f=[];if(!isNaN(m)){for(d in j){if(!isNaN(d)){var e=j[d];var k=h.data[m][e];f.push(i(k,e))}}g+=f.join(h.delimiter)+"\n"}}c.handleCallback(l,g);return g},toXLSX:function(g,j){var f=c.deepMerge({name:"amCharts",dateFormat:c.config.dateFormat||"dateObject",withHeader:true,stringify:false},g||{},true);var i="";var h={SheetNames:[],Sheets:{}};f.data=f.data?f.data:c.getChartData(f);function d(l,k){if(k){l+=1462}var m=Date.parse(l);return(m-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function e(q,p){var l={};var m={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var o=0;o!=q.length;++o){for(var r=0;r!=q[o].length;++r){if(m.s.r>o){m.s.r=o}if(m.s.c>r){m.s.c=r}if(m.e.r<o){m.e.r=o}if(m.e.c<r){m.e.c=r}var k={v:q[o][r]};if(k.v==null){continue}var n=XLSX.utils.encode_cell({c:r,r:o});if(typeof k.v==="number"){k.t="n"}else{if(typeof k.v==="boolean"){k.t="b"}else{if(k.v instanceof Date){k.t="n";k.z=XLSX.SSF._table[14];k.v=d(k.v)}else{k.t="s"}}}l[n]=k}}if(m.s.c<10000000){l["!ref"]=XLSX.utils.encode_range(m)}return l}h.SheetNames.push(f.name);h.Sheets[f.name]=e(c.toArray(f));i=XLSX.write(h,{bookType:"xlsx",bookSST:true,type:"base64"});i="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+i;c.handleCallback(j,i);return i},toArray:function(l,j){var k,d;var g=c.deepMerge({data:c.getChartData(l),withHeader:false,stringify:true},l||{},true);var f=[];var h=[];for(d in g.data[0]){h.push(d)}if(g.withHeader){f.push(h)}for(k in g.data){var e=[];if(!isNaN(k)){for(d in h){if(!isNaN(d)){var d=h[d];var i=g.data[k][d];if(i==null){i=""}else{if(g.stringify){i=String(i)}else{i=i}}e.push(i)}}f.push(e)}}c.handleCallback(j,f);return f},toByteArray:function(o,n){var m=c.deepMerge({},o||{});var k=(typeof Uint8Array!=="undefined")?Uint8Array:Array;var j="+".charCodeAt(0);var e="/".charCodeAt(0);var g="0".charCodeAt(0);var f="a".charCodeAt(0);var l="A".charCodeAt(0);var i=h(m.data);function d(p){var q=p.charCodeAt(0);if(q===j){return 62}if(q===e){return 63}if(q<g){return -1}if(q<g+10){return q-g+26+26}if(q<l+26){return q-l}if(q<f+26){return q-f+26}}function h(p){var t,s,q,u,r,v;if(p.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var w=p.length;r="="===p.charAt(w-2)?2:"="===p.charAt(w-1)?1:0;v=new k(p.length*3/4-r);q=r>0?p.length-4:p.length;var y=0;function x(z){v[y++]=z}for(t=0,s=0;t<q;t+=4,s+=3){u=(d(p.charAt(t))<<18)|(d(p.charAt(t+1))<<12)|(d(p.charAt(t+2))<<6)|d(p.charAt(t+3));x((u&16711680)>>16);x((u&65280)>>8);x(u&255)}if(r===2){u=(d(p.charAt(t))<<2)|(d(p.charAt(t+1))>>4);x(u&255)}else{if(r===1){u=(d(p.charAt(t))<<10)|(d(p.charAt(t+1))<<4)|(d(p.charAt(t+2))>>2);x((u>>8)&255);x(u&255)}}return v}c.handleCallback(n,i);return i},handleCallback:function(f){var d,e=Array();if(f&&f instanceof Function){for(d=0;d<arguments.length;d++){if(d>0){e.push(arguments[d])}}f.apply(c,e)}},handleDropbox:function(g){if(c.drawing.buffer.enabled){g.preventDefault();g.stopPropagation();if(g.type=="dragover"){c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active dropbox")}else{c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active");if(g.type=="drop"&&g.dataTransfer.files.length){for(var f=0;f<g.dataTransfer.files.length;f++){var d=new FileReader();d.onloadend=(function(e){return function(){c.drawing.handler.add({url:d.result,top:g.layerY-(e*10),left:g.layerX-(e*10)})}})(f);d.readAsDataURL(g.dataTransfer.files[f])}}}}},getChartData:function(s){var m=c.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},exportTitles:c.config.exportTitles,exportFields:c.config.exportFields,exportSelection:c.config.exportSelection,columnNames:c.config.columnNames},s||{},true);var l,j,i,h;var p=["valueField","openField","closeField","highField","lowField","xField","yField"];function f(v,w,u){function t(y,x){if(m.dataFields.indexOf(y)!=-1){return t([y,".",x].join(""))}return y}if(v&&m.exportTitles&&c.setup.chart.type!="gantt"){l=t(v,u);m.dataFieldsMap[l]=v;m.dataFields.push(l);m.titles[l]=w||l}}if(m.data.length==0){if(c.setup.chart.type=="stock"){m.data=c.setup.chart.mainDataSet.dataProvider;f(c.setup.chart.mainDataSet.categoryField);m.dateFields.push(c.setup.chart.mainDataSet.categoryField);for(j=0;j<c.setup.chart.mainDataSet.fieldMappings.length;j++){var g=c.setup.chart.mainDataSet.fieldMappings[j];for(i=0;i<c.setup.chart.panels.length;i++){var e=c.setup.chart.panels[i];for(h=0;h<e.stockGraphs.length;h++){var q=e.stockGraphs[h];for(i4=0;i4<p.length;i4++){if(q[p[i4]]==g.toField){f(g.fromField,q.title,p[i4])}}}}}for(j=0;j<c.setup.chart.comparedGraphs.length;j++){var q=c.setup.chart.comparedGraphs[j];for(i=0;i<q.dataSet.dataProvider.length;i++){for(h=0;h<q.dataSet.fieldMappings.length;h++){var g=q.dataSet.fieldMappings[h];var l=q.dataSet.id+"_"+g.toField;if(i<m.data.length){m.data[i][l]=q.dataSet.dataProvider[i][g.fromField];if(!m.titles[l]){f(l,q.dataSet.title)}}}}}}else{if(c.setup.chart.type=="gantt"){f(c.setup.chart.categoryField);m.dateFields.push(c.setup.chart.categoryField);var o=c.setup.chart.segmentsField;for(j=0;j<c.setup.chart.dataProvider.length;j++){var d=c.setup.chart.dataProvider[j];if(d[o]){for(i=0;i<d[o].length;i++){d[o][i][c.setup.chart.categoryField]=d[c.setup.chart.categoryField];m.data.push(d[o][i])}}}for(j=0;j<c.setup.chart.graphs.length;j++){var q=c.setup.chart.graphs[j];for(i=0;i<p.length;i++){var r=p[i];var k=q[r];var n=q.title;f(k,q.title,r)}}}else{if(["pie","funnel"].indexOf(c.setup.chart.type)!=-1){m.data=c.setup.chart.dataProvider;f(c.setup.chart.titleField);m.dateFields.push(c.setup.chart.titleField);f(c.setup.chart.valueField)}else{if(c.setup.chart.type!="map"){m.data=c.setup.chart.dataProvider;if(c.setup.chart.categoryAxis){f(c.setup.chart.categoryField,c.setup.chart.categoryAxis.title);if(c.setup.chart.categoryAxis.parseDates!==false){m.dateFields.push(c.setup.chart.categoryField)}}for(j=0;j<c.setup.chart.graphs.length;j++){var q=c.setup.chart.graphs[j];for(i=0;i<p.length;i++){var r=p[i];var k=q[r];f(k,q.title,r)}}}}}}}return c.processData(m)},processData:function(n){var h=c.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},dataDateFormat:c.setup.chart.dataDateFormat,dateFormat:c.config.dateFormat||c.setup.chart.dataDateFormat||"YYYY-MM-DD",exportTitles:c.config.exportTitles,exportFields:c.config.exportFields,exportSelection:c.config.exportSelection,columnNames:c.config.columnNames},n||{},true);var e,d;if(h.data.length){for(e=0;e<h.data.length;e++){for(d in h.data[e]){if(h.dataFields.indexOf(d)==-1){h.dataFields.push(d);h.dataFieldsMap[d]=d}}}if(h.exportFields!==undefined){h.dataFields=h.dataFields.filter(function(o){return h.exportFields.indexOf(o)!=-1})}var f=[];for(e=0;e<h.data.length;e++){var g={};var l=false;for(d=0;d<h.dataFields.length;d++){var k=h.dataFields[d];var m=h.dataFieldsMap[k];var i=(h.columnNames&&h.columnNames[k])||h.titles[k]||k;var j=h.data[e][m];if(j==null){j=undefined}if(h.exportTitles&&c.setup.chart.type!="gantt"){if(i in g){i+=["( ",k," )"].join("")}}if(h.dateFields.indexOf(m)!=-1){if(h.dataDateFormat&&(j instanceof String||typeof j=="string")){j=AmCharts.stringToDate(j,h.dataDateFormat)}else{if(h.dateFormat&&(j instanceof Number||typeof j=="number")){j=new Date(j)}}if(h.exportSelection){if(j instanceof Date){if(j<b.startDate||j>b.endDate){l=true}}else{if(e<b.startIndex||e>b.endIndex){l=true}}}if(h.dateFormat&&h.dateFormat!="dateObject"&&j instanceof Date){j=AmCharts.formatDate(j,h.dateFormat)}}g[i]=j}if(!l){f.push(g)}}h.data=f}return h.data},capitalize:function(d){return d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()},createMenu:function(f,d){var g;function e(o,i){var l,j,p=document.createElement("ul");for(l=0;l<o.length;l++){var w=typeof o[l]==="string"?{format:o[l]}:o[l];var v=document.createElement("li");var t=document.createElement("a");var n=document.createElement("img");var u=document.createElement("span");var k=String(w.action?w.action:w.format).toLowerCase();w.format=String(w.format).toUpperCase();if(c.config.formats[w.format]){w=c.deepMerge({label:w.icon?"":w.format,format:w.format,mimeType:c.config.formats[w.format].mimeType,extension:c.config.formats[w.format].extension,capture:c.config.formats[w.format].capture,action:c.config.action,fileName:c.config.fileName},w)}else{if(!w.label){w.label=w.label?w.label:c.i18l("menu.label."+k)}}if(["CSV","JSON","XLSX"].indexOf(w.format)!=-1&&["map","gauge"].indexOf(c.setup.chart.type)!=-1){continue}else{if(!c.setup.hasBlob&&w.format!="UNDEFINED"){if(w.mimeType&&w.mimeType.split("/")[0]!="image"&&w.mimeType!="text/plain"){continue}}}if(w.action=="draw"){if(c.config.fabric.drawing.enabled){w.menu=w.menu?w.menu:c.config.fabric.drawing.menu;w.click=(function(x){return function(){this.capture(x,function(){this.createMenu(x.menu)})}})(w)}else{w.menu=[]}}else{if(!w.populated&&w.action&&w.action.indexOf("draw.")!=-1){var s=w.action.split(".")[1];var r=w[s]||c.config.fabric.drawing[s]||[];w.menu=[];w.populated=true;for(j=0;j<r.length;j++){var m={label:r[j]};if(s=="shapes"){var q=r[j].indexOf("//")==-1;var h=(q?c.config.path+"shapes/":"")+r[j];m.action="add";m.url=h;m.icon=h;m.ignore=q;m["class"]="export-drawing-shape"}else{if(s=="colors"){m.style="background-color: "+r[j];m.action="change";m.color=r[j];m["class"]="export-drawing-color"}else{if(s=="widths"){m.action="change";m.width=r[j];m.label=document.createElement("span");m.label.style.width=c.numberToPx(r[j]);m.label.style.height=c.numberToPx(r[j]);m["class"]="export-drawing-width"}else{if(s=="opacities"){m.style="opacity: "+r[j];m.action="change";m.opacity=r[j];m.label=(r[j]*100)+"%";m["class"]="export-drawing-opacity"}else{if(s=="modes"){m.label=c.i18l("menu.label.draw.modes."+r[j]);m.click=(function(x){return function(){c.drawing.mode=x}})(r[j]);m["class"]="export-drawing-mode"}}}}}w.menu.push(m)}}else{if(!w.click&&!w.menu&&!w.items){if(c.drawing.handler[k] instanceof Function){w.action=k;w.click=(function(x){return function(){this.drawing.handler[x.action](x)}})(w)}else{if(c.drawing.buffer.enabled){w.click=(function(x){return function(){if(this.config.drawing.autoClose){this.drawing.handler.done()}this["to"+x.format](x,function(y){if(x.action=="download"){this.download(y,x.mimeType,[x.fileName,x.extension].join("."))}})}})(w)}else{if(w.format!="UNDEFINED"){w.click=(function(x){return function(){if(x.capture||x.action=="print"||x.format=="PRINT"){this.capture(x,function(){if(this.config.drawing.autoClose){this.drawing.handler.done()}this["to"+x.format](x,function(y){if(x.action=="download"){this.download(y,x.mimeType,[x.fileName,x.extension].join("."))}})})}else{if(this["to"+x.format]){this["to"+x.format](x,function(y){this.download(y,x.mimeType,[x.fileName,x.extension].join("."))})}else{throw new Error("Invalid format. Could not determine output type.")}}}})(w)}}}}}}if(w.menu!==undefined&&!w.menu.length){continue}t.setAttribute("href","#");t.addEventListener("click",(function(y,x){return function(A){A.preventDefault();var z=[A,x];if((x.action=="draw"||x.format=="PRINT"||(x.format!="UNDEFINED"&&x.capture))&&!c.drawing.enabled){x.delay=x.delay?x.delay:c.config.delay;if(x.delay){c.delay(x,y);return}}y.apply(c,z)}})(w.click||function(x){x.preventDefault()},w));v.appendChild(t);if(c.isElement(w.label)){u.appendChild(w.label)}else{u.innerHTML=w.label}if(w["class"]){v.className=w["class"]}if(w.style){v.setAttribute("style",w.style)}if(w.icon){n.setAttribute("src",(!w.ignore&&w.icon.slice(0,10).indexOf("//")==-1?b.pathToImages:"")+w.icon);t.appendChild(n)}if(w.label){t.appendChild(u)}if(w.title){t.setAttribute("title",w.title)}if(c.config.menuReviver){v=c.config.menuReviver.apply(c,[w,v])}w.elements={li:v,a:t,img:n,span:u};if((w.menu||w.items)&&w.action!="draw"){if(e(w.menu||w.items,v).childNodes.length){p.appendChild(v)}}else{p.appendChild(v)}}if(p.childNodes.length){i.appendChild(p)}return p}if(!d){if(typeof c.config.divId=="string"){c.config.divId=d=document.getElementById(c.config.divId)}else{if(c.isElement(c.config.divId)){d=c.config.divId}else{d=c.setup.chart.containerDiv}}}if(c.isElement(c.setup.menu)){c.setup.menu.innerHTML=""}else{c.setup.menu=document.createElement("div")}c.setup.menu.setAttribute("class",c.setup.chart.classNamePrefix+"-export-menu "+c.setup.chart.classNamePrefix+"-export-menu-"+c.config.position+" amExportButton");if(c.config.menuWalker){e=c.config.menuWalker}e.apply(this,[f,c.setup.menu]);if(c.setup.menu.childNodes.length){d.appendChild(c.setup.menu)}return c.setup.menu},delay:function(f,k){var d=c.deepMerge({delay:3,precision:2},f||{});var h,g,j=Number(new Date());var i=c.createMenu([{label:c.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(d.delay,d.precision)),title:c.i18l("capturing.delayed.menu.title"),"class":"export-delayed-capturing",click:function(){clearTimeout(h);clearTimeout(g);c.createMenu(c.config.menu)}}]);var e=i.getElementsByTagName("a")[0];h=setInterval(function(){var l=d.delay-(Number(new Date())-j)/1000;if(l<=0){clearTimeout(h);if(d.action!="draw"){c.createMenu(c.config.menu)}}else{if(e){e.innerHTML=c.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(l,2))}}},10);g=setTimeout(function(){k.apply(c,arguments)},d.delay*1000)},migrateSetup:function(d){var e={enabled:true,migrated:true,libs:{autoLoad:true},menu:[]};function f(g){var h;for(h in g){var i=g[h];if(h.slice(0,6)=="export"&&i){e.menu.push(h.slice(6))}else{if(h=="userCFG"){f(i)}else{if(h=="menuItems"){e.menu=i}else{if(h=="libs"){e.libs=i}else{if(typeof h=="string"){e[h]=i}}}}}}}f(d);return e},loadListeners:function(){function d(e){if(e){e.set({top:e.top+10,left:e.left+10});c.setup.fabric.add(e)}}if(c.config.keyListener&&c.config.keyListener!="attached"){c.config.keyListener="attached";document.addEventListener("keydown",function(g){var f=c.drawing.buffer.target;if((g.keyCode==8||g.keyCode==46)&&f){g.preventDefault();c.setup.fabric.remove(f)}else{if(g.keyCode==27&&c.drawing.enabled){g.preventDefault();c.drawing.handler.done()}else{if(g.keyCode==67&&(g.metaKey||g.ctrlKey)&&f){c.drawing.buffer.copy=f}else{if(g.keyCode==88&&(g.metaKey||g.ctrlKey)&&f){c.drawing.buffer.copy=f;c.setup.fabric.remove(f)}else{if(g.keyCode==86&&(g.metaKey||g.ctrlKey)){if(c.drawing.buffer.copy){d(c.drawing.buffer.copy.clone(d))}}else{if(g.keyCode==90&&(g.metaKey||g.ctrlKey)){g.preventDefault();if(g.shiftKey){c.drawing.handler.redo()}else{c.drawing.handler.undo()}}}}}}}})}if(c.config.fileListener){c.setup.chart.containerDiv.addEventListener("dragover",c.handleDropbox);c.setup.chart.containerDiv.addEventListener("dragleave",c.handleDropbox);c.setup.chart.containerDiv.addEventListener("drop",c.handleDropbox)}},init:function(){clearTimeout(c.timer);c.timer=setInterval(function(){if(c.setup.chart.containerDiv){clearTimeout(c.timer);if(c.config.enabled){c.setup.chart.AmExport=c;if(c.config.overflow){c.setup.chart.div.style.overflow="visible"}c.loadListeners();c.createMenu(c.config.menu)}}},AmCharts.updateRate)},construct:function(){c.drawing.handler.cancel=c.drawing.handler.done;try{c.setup.hasBlob=!!new Blob}catch(d){}window.safari=window.safari?window.safari:{};c.defaults.fabric.drawing.fontSize=c.setup.chart.fontSize||11;c.config.drawing=c.deepMerge(c.defaults.fabric.drawing,c.config.drawing||{},true);c.deepMerge(c.defaults.fabric,c.config,true);c.deepMerge(c.defaults.fabric,c.config.fabric||{},true);c.deepMerge(c.defaults.pdfMake,c.config,true);c.deepMerge(c.defaults.pdfMake,c.config.pdfMake||{},true);c.deepMerge(c.libs,c.config.libs||{},true);c.config.drawing=c.defaults.fabric.drawing;c.config.fabric=c.defaults.fabric;c.config.pdfMake=c.defaults.pdfMake;c.config=c.deepMerge(c.defaults,c.config,true);if(c.config.fabric.drawing.enabled){if(c.config.fabric.drawing.menu===undefined){c.config.fabric.drawing.menu=[];c.deepMerge(c.config.fabric.drawing.menu,[{"class":"export-drawing",menu:[{label:c.i18l("menu.label.draw.add"),menu:[{label:c.i18l("menu.label.draw.shapes"),action:"draw.shapes"},{label:c.i18l("menu.label.draw.text"),action:"text"}]},{label:c.i18l("menu.label.draw.change"),menu:[{label:c.i18l("menu.label.draw.modes"),action:"draw.modes"},{label:c.i18l("menu.label.draw.colors"),action:"draw.colors"},{label:c.i18l("menu.label.draw.widths"),action:"draw.widths"},{label:c.i18l("menu.label.draw.opacities"),action:"draw.opacities"},"UNDO","REDO"]},{label:c.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},"PRINT","CANCEL"]}])}}if(c.config.menu===undefined){c.config.menu=[];c.deepMerge(c.config,{menu:[{"class":"export-main",menu:[{label:c.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},{label:c.i18l("menu.label.save.data"),menu:["CSV","XLSX","JSON"]},{label:c.i18l("menu.label.draw"),action:"draw",menu:c.config.fabric.drawing.menu},{format:"PRINT",label:c.i18l("menu.label.print")}]}]})}if(!c.libs.path){c.libs.path=c.config.path+"libs/"}if(c.isSupported()){c.loadDependencies(c.libs.resources,c.libs.reload);c.setup.chart.addClassNames=true;c.setup.chart[c.name]=c;c.init()}}};if(a){c.config=a}else{if(c.setup.chart[c.name]){c.config=c.setup.chart[c.name]}else{if(c.setup.chart.amExport||c.setup.chart.exportConfig){c.config=c.migrateSetup(c.setup.chart.amExport||c.setup.chart.exportConfig)}else{return}}}c.construct();return c.deepMerge(this,c)}})();AmCharts.addInitHandler(function(a){new AmCharts["export"](a)},["pie","serial","xy","funnel","radar","gauge","stock","map","gantt"]);